@echo off
REM --- Set Variables ---
set CLAMDIR=C:\ClamAV
set CLAMZIP=clamav-1.5.1-win-x64.zip
set DOWNLOAD_URL=https://www.clamav.net/downloads/production/clamav-1.5.1.win.x64.zip
:: ---------- Create VBScript -----------------
pushd "%TEMP%"
   ( echo Dim objFolder, objShell, file, WS, TempPath
    echo Set objShell = CreateObject^("Shell.Application"^)
    echo Set objFolder = objShell.BrowseForFolder^(0, "Select Folder for Batch File", 0, ssfWINDOWS^)
    echo Set objFolder = objFolder.Self
    echo set WS=CreateObject^("WScript.Shell"^)
    echo TempPath = WS.ExpandEnvironmentStrings^("%TEMP%"^)
    echo Set file = CreateObject^("Scripting.FileSystemObject"^).OpenTextFile^(TempPath ^& "\IsPath.TXT", 2, True^)
    echo file.Write^(objFolder.Path^)
    echo file.Close
   )>BrowseFolder.vbs
popd "%TEMP%"
::--------------------------------------------------

:MainMenu
  chcp 437
  Echo.[30;40m
  cls
  if not "%1" == "max" start /MAX cmd /c %0 max & goto :eof
  title ClamAV Installer + Updater + Full System Scan
  Echo.[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ
  Echo.[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;41mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ
  Echo.[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[31;40mﬂ[30;41mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;41mﬂ[30;41mﬂ[30;41mﬂ[30;41mﬂ[30;41mﬂ[30;41mﬂ[30;41mﬂ[30;41mﬂ[30;41mﬂ[30;41mﬂ[30;41mﬂ[30;41mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;41mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ
  Echo.[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[31;41mﬂ[30;41mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;41mﬂ[30;41mﬂ[30;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[30;41mﬂ[30;41mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[31;41mﬂ[31;41mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ
  Echo.[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[31;40mﬂ[31;41mﬂ[31;41mﬂ[30;41mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;41mﬂ[30;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[30;41mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;41mﬂ[31;41mﬂ[31;41mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ
  Echo.[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[31;40mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[30;41mﬂ[30;40mﬂ[30;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[30;41mﬂ[30;40mﬂ[30;40mﬂ[30;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ
  Echo.[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[30;41mﬂ[30;41mﬂ[30;40mﬂ[30;40mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ
  Echo.[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[31;40mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ
  Echo.[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[31;40mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ
  Echo.[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;41mﬂ[31;41mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[31;41mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ
  Echo.[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[31;41mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[30;41mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[31;41mﬂ[31;41mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ
  Echo.[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[31;41mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[31;41mﬂ[31;41mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ
  Echo.[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[31;41mﬂ[31;41mﬂ[30;41mﬂ[30;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[30;41mﬂ[30;41mﬂ[31;41mﬂ[31;41mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ
  Echo.[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;40mﬂ[31;40mﬂ[31;40mﬂ[31;40mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;40mﬂ[31;40mﬂ[31;40mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ
  Echo.[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;40mﬂ[30;47mﬂ[30;47mﬂ[30;47mﬂ[31;40mﬂ[31;40mﬂ[31;41mﬂ[31;40mﬂ[30;40mﬂ[30;40mﬂ[30;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[30;41mﬂ[30;40mﬂ[30;40mﬂ[31;40mﬂ[31;41mﬂ[31;40mﬂ[30;47mﬂ[30;47mﬂ[30;47mﬂ[31;40mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ
  Echo.[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[31;40mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[30;47mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[37;40mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[30;40mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ
  Echo.[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[30;40mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[37;40mﬂ[30;40mﬂ[30;40mﬂ[37;47mﬂ[37;47mﬂ[30;47mﬂ[31;47mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;40mﬂ[31;47mﬂ[30;47mﬂ[37;47mﬂ[37;47mﬂ[30;40mﬂ[30;40mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[30;40mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ
  Echo.[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[30;40mﬂ[30;40mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[31;47mﬂ[31;47mﬂ[31;41mﬂ[31;41mﬂ[31;47mﬂ[31;47mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[30;47mﬂ[30;40mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[30;41mﬂ[31;41mﬂ[31;41mﬂ[31;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ
  Echo.[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[31;40mﬂ[31;41mﬂ[31;41mﬂ[37;41mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[30;40mﬂ[30;40mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[31;41mﬂ[31;41mﬂ[37;41mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[30;40mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[37;41mﬂ[31;41mﬂ[31;41mﬂ[31;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ
  Echo.[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;47mﬂ[30;47mﬂ[30;47mﬂ[30;47mﬂ[30;47mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;47mﬂ[30;40mﬂ[31;41mﬂ[37;41mﬂ[37;40mﬂ[37;47mﬂ[37;47mﬂ[30;40mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[37;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[37;41mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[37;47mﬂ[30;40mﬂ[37;47mﬂ[37;47mﬂ[37;40mﬂ[30;41mﬂ[31;40mﬂ[31;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;41mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;41mﬂ[30;40mﬂ[30;40mﬂ[30;47mﬂ[30;47mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ
  Echo.[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;47mﬂ[37;47mﬂ[37;40mﬂ[37;40mﬂ[30;40mﬂ[37;40mﬂ[37;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[37;47mﬂ[30;40mﬂ[31;40mﬂ[31;41mﬂ[31;41mﬂ[30;41mﬂ[30;41mﬂ[30;41mﬂ[37;41mﬂ[37;41mﬂ[37;41mﬂ[37;41mﬂ[30;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[37;41mﬂ[37;41mﬂ[37;41mﬂ[37;41mﬂ[37;41mﬂ[37;41mﬂ[30;41mﬂ[31;41mﬂ[31;41mﬂ[31;40mﬂ[31;41mﬂ[31;41mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[31;40mﬂ[31;41mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;41mﬂ[31;41mﬂ[30;40mﬂ[37;47mﬂ[37;47mﬂ[30;40mﬂ[37;47mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ
  Echo.[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[37;47mﬂ[37;47mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[37;47mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;47mﬂ[30;47mﬂ[30;47mﬂ[30;47mﬂ[30;47mﬂ[31;47mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[30;47mﬂ[31;47mﬂ[31;47mﬂ[30;47mﬂ[30;47mﬂ[30;47mﬂ[31;47mﬂ[31;47mﬂ[30;47mﬂ[30;47mﬂ[30;47mﬂ[31;47mﬂ[31;41mﬂ[31;41mﬂ[31;40mﬂ[31;40mﬂ[30;40mﬂ[30;41mﬂ[31;40mﬂ[31;41mﬂ[30;41mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[31;41mﬂ[30;41mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[31;41mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[37;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ
  Echo.[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[37;47mﬂ[37;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[37;47mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[31;40mﬂ[30;40mﬂ[37;47mﬂ[30;40mﬂ[31;41mﬂ[31;41mﬂ[37;47mﬂ[37;47mﬂ[30;41mﬂ[31;41mﬂ[31;41mﬂ[37;40mﬂ[37;47mﬂ[30;40mﬂ[31;41mﬂ[31;41mﬂ[30;40mﬂ[37;47mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;41mﬂ[31;41mﬂ[30;40mﬂ[30;40mﬂ[31;41mﬂ[30;41mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[31;41mﬂ[30;41mﬂ[30;40mﬂ[30;40mﬂ[31;41mﬂ[31;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ
  Echo.[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[37;47mﬂ[30;47mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[37;47mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;47mﬂ[30;47mﬂ[37;40mﬂ[37;40mﬂ[37;40mﬂ[37;47mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[37;47mﬂ[37;47mﬂ[31;40mﬂ[31;40mﬂ[31;40mﬂ[30;40mﬂ[37;47mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[37;47mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[31;41mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[31;40mﬂ[31;41mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[31;40mﬂ[31;41mﬂ[30;40mﬂ[30;41mﬂ[31;41mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ
  Echo.[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[37;40mﬂ[37;47mﬂ[30;47mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[37;47mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[37;47mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[37;47mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[37;47mﬂ[37;47mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[37;47mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[37;47mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[31;41mﬂ[31;40mﬂ[31;40mﬂ[31;40mﬂ[31;40mﬂ[31;40mﬂ[31;41mﬂ[31;41mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[31;41mﬂ[31;41mﬂ[31;41mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ
  Echo.[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[37;40mﬂ[37;47mﬂ[30;47mﬂ[30;47mﬂ[37;47mﬂ[37;40mﬂ[37;40mﬂ[30;40mﬂ[30;40mﬂ[37;40mﬂ[37;47mﬂ[30;47mﬂ[30;40mﬂ[30;40mﬂ[37;40mﬂ[37;47mﬂ[30;47mﬂ[30;47mﬂ[37;40mﬂ[37;40mﬂ[37;47mﬂ[30;40mﬂ[30;40mﬂ[37;47mﬂ[37;47mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[37;47mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[37;47mﬂ[30;40mﬂ[30;40mﬂ[31;41mﬂ[31;41mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[31;41mﬂ[30;41mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[31;41mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ[30;40mﬂ
  Echo.[0m
  echo.          Installing ClamAV + Updating DB + Scan
  echo.          Author: Tanutdech  Boonluelak, 2025. Modify by ChatGPT.
  Echo.[31;40m          Please Run on Administrator!!![0m
  echo.          1. Install ClamAV
  echo.          2. Update Data Base
  echo.          3. Scan Virus in DIR
  set /p c=Select your choice 
  if %c%==1 call :IsInstall
  if %c%==2 call :IsUpdate
  if %c%==3 call :ScanVirus
  if %c%==0 got :eof
goto :MainMenu

:IsInstall
  echo ============================================
  echo   Installing ClamAV + Updating DB + Scan
  echo ============================================
  echo.
  REM --- Create directory ---
  if not exist "%CLAMDIR%" (
      echo [*] Creating directory: %CLAMDIR%
      mkdir "%CLAMDIR%"
  )
  cd /d %CLAMDIR%
  echo.
  echo [*] Downloading ClamAV package...
  curl -L -o "%CLAMZIP%" "%DOWNLOAD_URL%"
  if %errorlevel% neq 0 (
      echo [ERROR] Cannot download ClamAV.
      pause
      goto :eof
  )
  REM --- Check if the file was downloaded correctly ---
  echo [*] Verifying downloaded ZIP file size...
  for %%F in (%CLAMZIP%) do set FILESIZE=%%~zF
  if %FILESIZE% LSS 10000 (
      echo [ERROR] The downloaded file is too small, indicating a possible download failure.
      pause
      goto :eof
  )
  REM --- Verify the ZIP file integrity ---
  echo [*] Verifying ZIP file integrity...
  powershell -Command "try { $zip = [System.IO.Compression.ZipFile]::OpenRead('%CLAMZIP%'); $zip.Close(); exit 0 } catch { exit 1 }"
  if %errorlevel% neq 0 (
      echo [ERROR] ZIP file is corrupted.
      pause
      goto :eof
  )
  REM --- Extract ClamAV using Windows Shell (COM Object) ---
  echo [*] Extracting ClamAV using Windows Shell...
  powershell -command ^
  "$s = New-Object -ComObject Shell.Application;" ^
  "$z = $s.NameSpace('%CLAMDIR%\%CLAMZIP%');" ^
  "$d = $s.NameSpace('%CLAMDIR%');" ^
  "$d.CopyHere($z.Items(),16)"
  if %errorlevel% neq 0 (
      echo [ERROR] Failed to extract ClamAV using Windows Shell.
      pause
      goto :eof
  )
  echo [*] Extraction completed successfully.
goto :eof

:IsUpdate
  REM --- Check if freshclam.exe exists ---
  if exist "%CLAMDIR%\clamav-1.5.1.win.x64\freshclam.exe" (
      echo [*] freshclam.exe found, proceeding with update...
  ) else (
      echo [ERROR] freshclam.exe not found at "%CLAMDIR%\clamav-1.5.1.win.x64\".
      pause
      goto :eof
  )
  REM --- Updating virus database (freshclam) ---
  echo [*] Updating virus database (freshclam)...
  "%CLAMDIR%\clamav-1.5.1.win.x64\freshclam.exe"
  if %errorlevel% neq 0 (
      echo [ERROR] freshclam failed.
      pause
      goto :eof
  )
goto :eof

:ScanVirus
  REM --- Starting Full System Scan ---
  echo.
  echo ============================================
  echo    Starting Full System Scan (with remove)
  echo ============================================
  echo.
  wscript "%TEMP%\BrowseFolder.vbs"
  for /f "tokens=*" %%d in ('type %TEMP%\IsPath.TXT') do  "%CLAMDIR%\clamav-1.5.1.win.x64\clamscan.exe" -r "%%d" -a --bell --remove=yes
  echo.
  echo ============================================
  echo       Scan Completed
  echo ============================================
  pause
goto :eof
